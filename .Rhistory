factors <- c("state", "type_code", "type", "gender")
suicide[,(factors):=lapply(.SD,as.factor),.SDcols=factors]
suicide$year <- as.Date(as.character(suicide$year),format="%Y")
View(suicide)
temp <- suicide %>% group_by(type_code,type) %>% summarise(count=n())
View(temp)
temp <- suicide %>% group_by(type_code,type) %>% summarise(count=n()) %>% arrange(desc(count))
View(temp)
temp <- suicide %>% filter(type_code=="Causes") %>% group_by(type) %>% summarise(count=n()) %>% mutate(perc=round(count/sum(count)*100)) %>% arrange(desc(perc))
View(temp)
temp <- suicide %>% filter(type_code=="Causes") %>% group_by(type) %>% summarise(total_cases=sum(total)) %>% mutate(perc=round(count/sum(count)*100)) %>% arrange(desc(perc))
temp <- suicide %>% filter(type_code=="Causes") %>% group_by(type) %>% summarise(total_cases=sum(total)) %>% mutate(perc=round(total_cases/sum(total_cases)*100)) %>% arrange(desc(perc))
View(temp)
temp <- suicide %>% filter(type_code=="Causes" & !grep('*Causes',type)) %>% group_by(type) %>% summarise(total_cases=sum(total)) %>% mutate(perc=round(total_cases/sum(total_cases)*100)) %>% arrange(desc(perc))
temp <- suicide %>% filter(type_code=="Causes") %>% filter(!grepl('*Causes',type)) %>% group_by(type) %>% summarise(total_cases=sum(total)) %>% mutate(perc=round(total_cases/sum(total_cases)*100)) %>% arrange(desc(perc))
View(temp)
ggplot(temp,aes(type,total_cases,col=type))+geom_bar(stat="identity")+geom_text(aes(label=perc,vjust=0.5))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')
ggplot(temp,aes(type,total_cases,col=type))+geom_bar(stat="identity")+geom_text(aes(label=perc,vjust=0.5))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')
ggplot(temp,aes(type,total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=perc,vjust=0.8))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')
ggplot(temp,aes(type,total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=perc,vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')
ggplot(temp,aes(type,total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=perc,vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)
ggplot(temp,aes(factor(type,type),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=perc,vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)
ggplot(temp,aes(factor(type,type),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=paste(perc,"%",vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)
ggplot(temp,aes(factor(type,type),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=paste(perc,"%"),vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)
ggplot(temp,aes(factor(type,type),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=paste(perc,"%"),vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)+coord_flip()
ggplot(temp,aes(reorder(type),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=paste(perc,"%"),vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)+coord_flip()
ggplot(temp,aes(reorder(type,total_cases),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=paste(perc,"%"),vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)+coord_flip()
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
library(tidyverse)
library(lubridate)
library(janitor)
library(ggthemes)
library(data.table)
library(RColorBrewer)
suicide <- fread("Suicides in India 2001-2012.csv",header=TRUE,stringsAsFactors = FALSE)
library(forcats)
suicide <- suicide %>% clean_names()
factors <- c("state", "type_code", "type", "gender")
suicide[,(factors):=lapply(.SD,as.factor),.SDcols=factors]
suicide$year <- as.Date(as.character(suicide$year),format="%Y")
levels(suicide$type)
temp <- suicide %>% filter(type_code=="Causes") %>% filter(!grepl('*Causes',type)) %>% group_by(type) %>% summarise(total_cases=sum(total)) %>% mutate(perc=round(total_cases/sum(total_cases)*100)) %>% arrange(desc(perc))
levels(temp$type)
unique(temp$type)
temp <- temp %>% mutate(type=fct_collapse(type,"Illness"=c("Other Prolonged Illness","Insanity/Mental Illness","Cancer","Illness (Aids/STD)","Paralysis"),"Pregnancy Related"=c("Not having Children(Barrenness/Impotency","Illegitimate Pregnancy","Not having Children (Barrenness/Impotency"),"Family Issues"=c("Family Problems","Dowry Dispute","Property Dispute","Physical Abuse (Rape/Incest Etc.)","Bankruptcy or Sudden change in Economic Status","Suspected/Illicit Relation","Fall in Social Reputation"),"Career Related"=c("Failure in Examination","Unemployment","Poverty","Professional/Career Problem"),"Emotional Causes"=c("Death of Dear Person","Love Affairs","Drug Abuse/Addiction","Divorce"),"Dowry Issues"=c("Dowry Dispute","Cancellation/Non-Settlement of Marriage")))
View(temp)
temp <- temp %>% group_by(type) %>% summarise(total_cases=sum(total)) %>% mutate(perc=round(total_cases/sum(total_cases)*100)) %>% arrange(desc(perc))
temp <- temp %>% group_by(type) %>% summarise(total_cases=sum(total_cases)) %>% mutate(perc=round(total_cases/sum(total_cases)*100)) %>% arrange(desc(perc))
ggplot(temp,aes(reorder(type,total_cases),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=paste(perc,"%"),vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)+coord_flip()
temp <- temp %>% mutate(type=fct_collapse(type,"Illness"=c("Other Prolonged Illness","Insanity/Mental Illness","Cancer","Illness (Aids/STD)","Paralysis"),"Pregnancy Related"=c("Not having Children(Barrenness/Impotency","Illegitimate Pregnancy","Not having Children (Barrenness/Impotency"),"Family Issues"=c("Family Problems","Dowry Dispute","Property Dispute","Physical Abuse (Rape/Incest Etc.)","Bankruptcy or Sudden change in Economic Status","Suspected/Illicit Relation","Fall in Social Reputation","Bankruptcy or Sudden change in Economic"),"Career Related"=c("Failure in Examination","Unemployment","Poverty","Professional/Career Problem"),"Emotional Causes"=c("Death of Dear Person","Love Affairs","Drug Abuse/Addiction","Divorce"),"Dowry Issues"=c("Dowry Dispute","Cancellation/Non-Settlement of Marriage")))
temp <- temp %>% group_by(type) %>% summarise(total_cases=sum(total_cases)) %>% mutate(perc=round(total_cases/sum(total_cases)*100)) %>% arrange(desc(perc))
ggplot(temp,aes(reorder(type,total_cases),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=paste(perc,"%"),vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)+coord_flip()
suicide <- suicide %>% mutate(type=fct_collapse(type,"Illness"=c("Other Prolonged Illness","Insanity/Mental Illness","Cancer","Illness (Aids/STD)","Paralysis"),"Pregnancy Related"=c("Not having Children(Barrenness/Impotency","Illegitimate Pregnancy","Not having Children (Barrenness/Impotency"),"Family Issues"=c("Family Problems","Dowry Dispute","Property Dispute","Physical Abuse (Rape/Incest Etc.)","Bankruptcy or Sudden change in Economic Status","Suspected/Illicit Relation","Fall in Social Reputation","Bankruptcy or Sudden change in Economic"),"Career Related"=c("Failure in Examination","Unemployment","Poverty","Professional/Career Problem"),"Emotional Causes"=c("Death of Dear Person","Love Affairs","Drug Abuse/Addiction","Divorce"),"Dowry Issues"=c("Dowry Dispute","Cancellation/Non-Settlement of Marriage")))
View(suicide)
unique(suicide$type)
suicide <- suicide %>% mutate(type=fct_collapse(type,"Illness"=c("Other Prolonged Illness","Insanity/Mental Illness","Cancer","Illness (Aids/STD)","Paralysis"),"Pregnancy Related"=c("Not having Children(Barrenness/Impotency","Illegitimate Pregnancy","Not having Children (Barrenness/Impotency"),"Family Issues"=c("Family Problems","Dowry Dispute","Property Dispute","Physical Abuse (Rape/Incest Etc.)","Bankruptcy or Sudden change in Economic Status","Suspected/Illicit Relation","Fall in Social Reputation","Bankruptcy or Sudden change in Economic"),"Career Related"=c("Failure in Examination","Unemployment","Poverty","Professional/Career Problem"),"Emotional Causes"=c("Death of Dear Person","Love Affairs","Drug Abuse/Addiction","Divorce"),"Dowry Issues"=c("Dowry Dispute","Cancellation/Non-Settlement of Marriage"),"Others/Not Known"=c("Other Causes (Please Specity)","Causes Not known")))
%>% group_by(type) %>% summarise(total_cases=sum(total_cases)) %>% mutate(perc=round(total_cases/sum(total_cases)*100)) %>% arrange(desc(perc))
ggplot(temp,aes(reorder(type,total_cases),total_cases,fill=type))+geom_bar(stat="identity")+geom_text(aes(label=paste(perc,"%"),vjust=0.01))+theme_fivethirtyeight()+theme(legend.position="none",axis.text.x=element_text(angle=90))+ggtitle('Cause of Suicides')+scale_y_continuous(labels=scales::comma)+coord_flip()
View(temp)
class(suicide$age_group)
ggplot(suicide,aes(age_group))+geom_histogram(binwidth=5,aes(y=..density..),fill=gender)+theme_fivethirtyeight()+theme(legend.position="bottom")+ggtitle("Age Distribution")
ggplot(suicide,aes(age_group))+geom_histogram(binwidth=5,aes(y=..density..,fill=gender))+theme_fivethirtyeight()+theme(legend.position="bottom")+ggtitle("Age Distribution")
ggplot(suicide,aes(age_group))+geom_histogram(binwidth=5,aes(y=..count..,fill=gender))+theme_fivethirtyeight()+theme(legend.position="bottom")+ggtitle("Age Distribution")
ggplot(suicide,aes(age_group))+geom_histogram(binwidth=5,aes(y=..count..,fill=gender),stat="count")+theme_fivethirtyeight()+theme(legend.position="bottom")+ggtitle("Age Distribution")
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message = FALSE)
library(data.table)
library(tidyverse)
library(tidyverse)
library(gridExtra)
survey=fread('HackerRank-Developer-Survey-2018-Values.csv')
summary(survey)
print("Total Number of respondents:",length(distinct(survey$RespondentID)))
print("Total Number of respondents:",length(unique(survey$RespondentID)))
cat("Total Number of respondents:",length(unique(survey$RespondentID)))
library(janitor)
survey <- survey %>% clean_names()
View(survey)
temp <- survey[,(Respondents):=.N,by=.(countrynumeric2)]
temp <- survey[,respondents:=.N,by=.(countrynumeric2)]
View(survey)
temp <- survey[,.(respondents=.N),by=.(countrynumeric2)]
View(temp)
temp <- survey[,.(respondents=.N),by=.(countrynumeric2)][order(-respondents)]
View(temp)
temp <- survey[countrynumeric2!=" ",.(respondents=.N),by=.(countrynumeric2)][order(-respondents)]
View(temp)
temp <- survey[countrynumeric2!="",.(respondents=.N),by=.(countrynumeric2)][order(-respondents)]
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
library(ggthemes)
temp <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
View(temp)
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
#Visualising,
ggplot(temp,aes(countrynumeric2,respondents,fill="darkgreen"))+geom_bar(stat="identity")+theme_economist()+theme(axis.title = element_text(size=16),axis.text.x = element_text(rotation=90))+geom_text(aes(label(paste(perc,"%"))))+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?")
#Visualising,
ggplot(temp,aes(countrynumeric2,respondents,fill="darkgreen"))+geom_bar(stat="identity")+theme_economist()+theme(axis.title = element_text(size=16),axis.text.x = element_tex(angle=90))+geom_text(aes(label(paste(perc,"%"))))+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?")
#Visualising,
ggplot(temp,aes(countrynumeric2,respondents,fill="darkgreen"))+geom_bar(stat="identity")+theme_economist()+theme(axis.title = element_text(size=16),axis.text.x = element_text(angle=90))+geom_text(aes(label(paste(perc,"%"))))+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?")
#Visualising,
ggplot(temp,aes(countrynumeric2,respondents,fill="darkgreen"))+geom_bar(stat="identity")+theme_economist()+theme(axis.title = element_text(size=16),axis.text.x = element_text(angle=90))+geom_text(aes(label=paste(perc,"%")))+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?")
#Visualising,
ggplot(temp,aes(countrynumeric2,respondents,fill="darkgreen"))+geom_bar(stat="identity")+theme_bw()+theme(axis.title = element_text(size=16),axis.text.x = element_text(angle=90),legend.position="None")+geom_text(aes(label=paste(perc,"%")))+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?")+coord_flip()
#Visualising,
ggplot(temp,aes(reorder(countrynumeric2,respondents),respondents,fill="darkgreen"))+geom_bar(stat="identity")+theme_bw()+theme(axis.title = element_text(size=16),axis.text.x = element_text(angle=90),legend.position="None")+geom_text(aes(label=paste(perc,"%")))+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?")+coord_flip()
#Visualising,
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill="darkgreen"))+geom_bar(stat="identity")+theme_bw()+theme(axis.title = element_text(size=16),axis.text.x = element_text(angle=90),legend.position="None")+geom_text(aes(label=paste(perc,"%")))+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?")+coord_flip()
#Visualising,
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+theme_bw()+theme(axis.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?",subtitle="Top 15 Countries")+coord_flip()
#Visualising,
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+theme_bw()+theme(plot.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?",subtitle="Top 15 Countries")+coord_flip()
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!'),.(respondents=.N),by=.(q3gender)]
View(temp)
my_theme <- function(){
theme_bw()+theme(plot.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))
}
#Visualising,
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?",subtitle="Top 15 Countries")+coord_flip()
temp <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
#Visualising,
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?",subtitle="Top 15 Countries")+coord_flip()
ggplot(head(temp,15),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!'),.(respondents=.N),by=.(q3gender)][order(-respondents)]
ggplot(head(temp),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
ggplot(head(temp),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
ggplot(head(temp),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
ggplot(head(temp),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0.5)+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
ggplot(head(temp),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & countrynumeric2 !="",.(respondents=.N,perc=round(tabulate(q3gender)/.N,2)),by=.(countrynumeric2,q3gender)][order(-respondents)]
survey$countrynumeric2 <- as.factor(survey$countrynumeric2)
survey$q3gender <- as.factor(survey$q3gender)
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & countrynumeric2 !="",.(respondents=.N,perc=round(tabulate(q3gender)/.N,2)),by=.(countrynumeric2,q3gender)][order(-respondents)]
View(temp)
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & countrynumeric2 !="",.(respondents=.N),by=.(countrynumeric2,q3gender)][order(-respondents)]
View(temp)
temp_gender <- survey[!q3gender %in% c('Non-Binary','#NULL!') & countrynumeric2 !="",.(respondents=.N),by=.(countrynumeric2,q3gender)][order(-respondents)]
temp <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
View(temp_gender)
temp_gender[,.(q3gender=unique(q3gender),perc=tabulate(q3gender)/.N),by=(countrynumeric2)]
tabulate(temp_gender$q3gender)
temp_gender %in% head(temp,15)
ggplot(temp_gender,aes(countrynumeric2,respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender across country?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender,aes(countrynumeric2 %in% head(temp$countrynumeric2,15),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender across country?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(countrynumeric2,respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(factor(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(factor(countrynumeric2,countrynumeric2),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(order(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,-respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")+coord_flip()
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")+coord_flip()
```{r,fig.height=12,fig.width=12}
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")+coord_flip()
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries')+theme(legend.position="bottom")+coord_flip()
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries',fill="Gender")+theme(legend.position="bottom")+coord_flip()
ggplot(survey,aes(q2age,..density..,fill=q3gender))+geom_histogram()+my_theme()+theme(legend.position="bottom")+labs(x="Age",y=" ",title="Age of the respondents")
ggplot(survey,aes(q2age,..count..,fill=q3gender))+geom_bar()+my_theme()+theme(legend.position="bottom")+labs(x="Age",y=" ",title="Age of the respondents")
ggplot(survey[!survey$q3gender %in% c('#NULL!','Non-Binary'),],aes(q2age,..count..,fill=q3gender))+geom_bar()+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")
ggplot(survey[!survey$q3gender %in% c('#NULL!','Non-Binary'),],aes(q2age,..count..,fill=q3gender))+geom_bar()+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
ggplot(survey[!survey$q3gender %in% c('#NULL!','Non-Binary'),],aes(q2age,..count..,fill=q3gender))+geom_bar(position="dodge")+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
ggplot(subset(survey,!survey$q3gender %in% c('#NULL!','Non-Binary')),aes(q2age,..count..,fill=q3gender))+geom_bar(position="dodge")+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
temp <- subset(survey,!survey$q3gender %in% c('#NULL!','Non-Binary'))
View(temp)
table(temp$q3gender)
ggplot(temp,aes(q2age,..count..,fill=q3gender))+geom_bar(position="dodge")+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
temp <- subset(survey,!survey$q3gender %in% c('#NULL!','Non-Binary'))
ggplot(temp,aes(q2age,..count..,fill=q3gender))+geom_bar(position="dodge")+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
temp <- subset(survey,survey$q3gender !%in% c('#NULL!','Non-Binary'))
temp <- subset(survey,!survey$q3gender %in% c('#NULL!','Non-Binary'))
ggplot(temp,aes(q2age,..count..,fill=q3gender))+geom_bar(position="dodge")+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!'),.(respondents=.N),by=.(q2age,q3gender)]
View(temp)
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!'),.(respondents=.N),by=.(q2age,q3gender)]
View(temp)
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!',.(respondents=.N),by=.(q2age,q3gender)]
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(position="dodge")+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(stat='identity',position="dodge")+my_theme()+theme(legend.position="bottom")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(stat='identity',position="dodge")+my_theme()+theme(legend.position="right")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(stat='identity',position="dodge")+my_theme()+theme(legend.position="right")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!' & !q1agebegincoding %in% '#NULL!',.(respondents=.N),.(q3gender,q2age,q1agebegincoding)]
View(temp)
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+facet_grid(~q2age,nrow=3)+theme(legend.position="none")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents the current age")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+facet_grid(~q2age)+theme(legend.position="none")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents the current age")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+facet_grid(~q2age,nrows=3)+theme(legend.position="none")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents the current age")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+facet_wrap(~q2age,nrows=3)+theme(legend.position="none")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents the current age")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+facet_wrap(~q2age,nrow=3)+theme(legend.position="none")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents the current age")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+facet_wrap(~q2age,nrow=3,scales="free_x")+theme(legend.position="none")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents the current age")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q2age))+geom_bar(stat='identity',position='stack')+facet_wrap(~q3gender)+theme(legend.position="none")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents the current age")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q2age))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q3gender)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Comparing between the gender")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q2gender))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q2age)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents current age",fill="Gender")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q2age)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents current age",fill="Gender")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q2age)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents current age",fill="Gender")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q2age)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents current age",fill="Gender")
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q2age)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents current age",fill="Gender")
survey$q1agebegincoding <- factor(survey$q1agebegincoding,levels=c('5 - 10 years old','11 - 15 years old','16 - 20 years old','21 - 25 years old','26 - 30 years old','31 - 35 years old','36 - 40 years old','41 - 50 years old','50+ years or older','#NULL!'))
survey$q2age <- factor(survey$q2age,levels=c("Under 12 years old
","12 - 18 years old","18 - 24 years old","25 - 34 years old","35 - 44 years old","45 - 54 years old","55 - 64 years old","65 - 74 years old","75 years or older"))
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!',.(respondents=.N),by=.(q2age,q3gender)]
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(stat='identity',position="dodge")+my_theme()+theme(legend.position="right")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(stat='identity',position="dodge")+my_theme()+theme(legend.position="right")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
View(temp)
survey=fread('HackerRank-Developer-Survey-2018-Values.csv')
survey <- survey %>% clean_names()
cat("Total Number of respondents:",length(unique(survey$RespondentID)))
my_theme <- function(){
theme_bw()+theme(plot.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))
}
survey$countrynumeric2 <- as.factor(survey$countrynumeric2)
survey$q3gender <- as.factor(survey$q3gender)
survey$q1agebegincoding <- factor(survey$q1agebegincoding,levels=c('5 - 10 years old','11 - 15 years old','16 - 20 years old','21 - 25 years old','26 - 30 years old','31 - 35 years old','36 - 40 years old','41 - 50 years old','50+ years or older','#NULL!'))
survey$q2age <- factor(survey$q2age,levels=c("Under 12 years old
","12 - 18 years old","18 - 24 years old","25 - 34 years old","35 - 44 years old","45 - 54 years old","55 - 64 years old","65 - 74 years old","75 years or older","#NULL!"))
cat("Total Number of respondents:",length(unique(survey$RespondentID)))
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!',.(respondents=.N),by=.(q2age,q3gender)]
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(stat='identity',position="dodge")+my_theme()+theme(legend.position="right")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
View(temp)
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!' & !q1agebegincoding %in% '#NULL!',.(respondents=.N),.(q3gender,q2age,q1agebegincoding)]
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q2age)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents current age",fill="Gender")
View(temp)
levels(survey$q2age)
survey=fread('HackerRank-Developer-Survey-2018-Values.csv')
survey <- survey %>% clean_names()
cat("Total Number of respondents:",length(unique(survey$respondentid)))
my_theme <- function(){
theme_bw()+theme(plot.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))
}
survey$countrynumeric2 <- as.factor(survey$countrynumeric2)
survey$q3gender <- as.factor(survey$q3gender)
survey$q1agebegincoding <- factor(survey$q1agebegincoding,levels=c('5 - 10 years old','11 - 15 years old','16 - 20 years old','21 - 25 years old','26 - 30 years old','31 - 35 years old','36 - 40 years old','41 - 50 years old','50+ years or older','#NULL!'))
survey$q2age <- factor(survey$q2age,levels=c("Under 12 years old","12 - 18 years old","18 - 24 years old","25 - 34 years old","35 - 44 years old","45 - 54 years old","55 - 64 years old","65 - 74 years old","75 years or older","#NULL!"))
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!',.(respondents=.N),by=.(q2age,q3gender)]
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(stat='identity',position="dodge")+my_theme()+theme(legend.position="right")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!' & !q1agebegincoding %in% '#NULL!',.(respondents=.N),.(q3gender,q2age,q1agebegincoding)]
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q2age)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents current age",fill="Gender")
levels(survey$q1agebegincoding)
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old"),.(respondents=.N),by=.(countrynumeric2)]
View(temp)
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & countrynumeric2 !="",.(respondents=.N),by=.(countrynumeric2)][order(-respondents)]
View(temp)
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
View(temp)
ggplot(head(temp,15),aes(countrynumeric2,respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+coord_flip()
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+coord_flip()
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()+scale_fill_canva()
canva_palettes
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()+scale_fill_brewer()
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()+scale_fill_brewer(palette="Set2")
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity",aes(fill="green"))+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity",aes(fill="lightpink"))+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity",aes(fill="pink"))+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity",aes(fill="pink"))+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()
survey$q5degreefocus <- as.factor(survey$q5degreefocus)
levels(survey$q5degreefocus)
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",degree:=ifelse(q5degreefocus="",q0005_other,q5degreefocus)]
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",q5degreefocus:=ifelse(q5degreefocus="",q0005_other,q5degreefocus)]
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",]
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",q5degreefocus:=ifelse(q5degreefocus=="",q0005_other,q5degreefocus)]
levels(temp$q5degreefocus)
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
View(temp)
survey=fread('HackerRank-Developer-Survey-2018-Values.csv')
survey <- survey %>% clean_names()
cat("Total Number of respondents:",length(unique(survey$respondentid)))
my_theme <- function(){
theme_bw()+theme(plot.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))
}
survey$countrynumeric2 <- as.factor(survey$countrynumeric2)
survey$q3gender <- as.factor(survey$q3gender)
survey$q1agebegincoding <- factor(survey$q1agebegincoding,levels=c('5 - 10 years old','11 - 15 years old','16 - 20 years old','21 - 25 years old','26 - 30 years old','31 - 35 years old','36 - 40 years old','41 - 50 years old','50+ years or older','#NULL!'))
survey$q2age <- factor(survey$q2age,levels=c("Under 12 years old","12 - 18 years old","18 - 24 years old","25 - 34 years old","35 - 44 years old","45 - 54 years old","55 - 64 years old","65 - 74 years old","75 years or older","#NULL!"))
survey$q5degreefocus <- as.factor(survey$q5degreefocus)
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
View(temp)
temp$q5degreefocus[temp$q5degreefocus==""]="Others"
View(temp)
temp$q5degreefocus[temp$q5degreefocus==NA]="Others"
View(temp)
temp[temp$q5degreefocus==NA]="Others"
View(temp)
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
View(temp)
library(forcats)
temp <- temp %>% mutate(q5degreefocus=fct_recode(q5degreefocus,""="Others"))
temp <- temp %>% mutate(q5degreefocus=fct_recode(q5degreefocus,"Others"=""))
View(temp)
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the youngest coders completed ?",subtitle="Each grid represents age they have started to code")
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the youngest coders completed ?",subtitle="Each grid represents age they have started to code")
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the youngest coders completed ?",subtitle="Each grid represents age they have started to code")
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the youngest coders completed ?",subtitle="Each grid represents age they have started to code")
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the youngest coders completed ?",subtitle="Each grid represents age they have started to code")
temp <- survey[!q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
View(temp)
temp <- survey[!q1agebegincoding %in% "#NULL!" & !q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
temp <- temp %>% mutate(q5degreefocus=fct_recode(q5degreefocus,"Others"=""))
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the coders completed ?",subtitle="Each grid represents age they have started to code")
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the coders completed ?",subtitle="Each grid represents age they have started to code")
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the coders completed ?",subtitle="Each grid represents age they have started to code")
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the coders completed ?",subtitle="Each grid represents age they have started to code")
temp_gender <- survey[!q3gender %in% c('Non-Binary','#NULL!') & countrynumeric2 !="",.(respondents=.N),by=.(countrynumeric2,q3gender)][order(-respondents)]
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries',fill="Gender")+theme(legend.position="bottom")+coord_flip()
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!'),.(respondents=.N),by=.(q3gender)][order(-respondents)]
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
ggplot(head(temp),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
temp_country <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
temp_country$perc <- round((temp_country$respondents/sum(temp_countrt$respondents))*100,2)
temp_country <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
temp_country$perc <- round((temp_country$respondents/sum(temp_country$respondents))*100,2)
#Visualising,
ggplot(head(temp_country,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?",subtitle="Top 15 Countries")+coord_flip()
temp_gender <- survey[!q3gender %in% c('Non-Binary','#NULL!') & countrynumeric2 !="",.(respondents=.N),by=.(countrynumeric2,q3gender)][order(-respondents)]
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp_country$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries',fill="Gender")+theme(legend.position="bottom")+coord_flip()
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message = FALSE)
library(data.table)
library(tidyverse)
library(gridExtra)
library(janitor)
library(ggthemes)
library(forcats)
survey=fread('HackerRank-Developer-Survey-2018-Values.csv')
survey <- survey %>% clean_names()
cat("Total Number of respondents:",length(unique(survey$respondentid)))
my_theme <- function(){
theme_bw()+theme(plot.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))
}
survey$countrynumeric2 <- as.factor(survey$countrynumeric2)
survey$q3gender <- as.factor(survey$q3gender)
survey$q1agebegincoding <- factor(survey$q1agebegincoding,levels=c('5 - 10 years old','11 - 15 years old','16 - 20 years old','21 - 25 years old','26 - 30 years old','31 - 35 years old','36 - 40 years old','41 - 50 years old','50+ years or older','#NULL!'))
survey$q2age <- factor(survey$q2age,levels=c("Under 12 years old","12 - 18 years old","18 - 24 years old","25 - 34 years old","35 - 44 years old","45 - 54 years old","55 - 64 years old","65 - 74 years old","75 years or older","#NULL!"))
survey$q5degreefocus <- as.factor(survey$q5degreefocus)
temp <- melt(survey,id.vars="respondentid",variable.name="Q6_Learn",measure.vars = 12:16)
View(temp)
names(survey)
temp <- melt(survey,id.vars=c("respondentid","q2age"),variable.name="Q6_Learn",measure.vars = 12:16)
View(temp)
View(temp)
temp <- temp[value !="",.(respondents=.N),by=.(value,q2age)][order(-respondents)]
View(temp)
library(viridis)
ggplot(temp,aes(value,respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age)+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current grade")+scale_fill_manual(values=viridis(20))
temp <- temp[value !=""& q2age!="#NULL",.(respondents=.N),by=.(value,q2age)][order(-respondents)]
View(temp)
temp <- melt(survey,id.vars=c("respondentid","q2age"),variable.name="Q6_Learn",measure.vars = 12:16)
temp <- temp[value !=""& !q2age=="#NULL",.(respondents=.N),by=.(value,q2age)][order(-respondents)]
temp <- temp %>% group_by(q2age) %>% mutate(perc=round(((temp$respondents)/sum(temp$respondents))*100,2))
temp <- temp %>% group_by(q2age) %>% mutate(perc=round(((respondents)/sum(respondents))*100,2))
View(temp)
table(temp$q2age)
temp <- melt(survey,id.vars=c("respondentid","q2age"),variable.name="Q6_Learn",measure.vars = 12:16)
temp <- temp[value !=""& !q2age=="#NULL!",.(respondents=.N),by=.(value,q2age)][order(-respondents)]
temp <- temp %>% group_by(q2age) %>% mutate(perc=round(((respondents)/sum(respondents))*100,2))
ggplot(temp,aes(value,respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age)+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current grade")+scale_fill_manual(values=viridis(20))+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)
ggplot(temp,aes(value,respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age)+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current grade")+scale_fill_manual(values=viridis(5))+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)
ggplot(temp,aes(value,respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age)+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current grade")+scale_fill_manual(values=viridis(9))+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)
temp <- temp %>% group_by(q2age) %>% mutate(perc=round(((respondents)/sum(respondents))*100,2)) %>% arrange(desc(perc))
ggplot(temp,aes(value,respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age,scale="free_y")+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current grade")+scale_fill_manual(values=viridis(9))+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)
ggplot(temp,aes(reorder(value,respondents),respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age,scale="free_y")+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current grade")+scale_fill_manual(values=viridis(9))+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)
ggplot(temp,aes(reorder(value,respondents),respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age,scale="free_y")+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current grade")+scale_fill_manual(values=viridis(9))+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)
ggplot(temp,aes(reorder(value,respondents),respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age,scale="free_y")+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current age")+scale_fill_manual(values=viridis(9))+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)
View(survey)
temp_country <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
temp_country$perc <- round((temp_country$respondents/sum(temp_country$respondents))*100,2)
#Visualising,
ggplot(head(temp_country,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?",subtitle="Top 15 Countries")+coord_flip()
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message = FALSE)
library(data.table)
library(tidyverse)
library(gridExtra)
library(janitor)
library(ggthemes)
library(forcats)
library(viridis)
survey=fread('HackerRank-Developer-Survey-2018-Values.csv')
survey <- survey %>% clean_names()
cat("Total Number of respondents:",length(unique(survey$respondentid)))
my_theme <- function(){
theme_bw()+theme(plot.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))
}
survey$countrynumeric2 <- as.factor(survey$countrynumeric2)
survey$q3gender <- as.factor(survey$q3gender)
survey$q1agebegincoding <- factor(survey$q1agebegincoding,levels=c('5 - 10 years old','11 - 15 years old','16 - 20 years old','21 - 25 years old','26 - 30 years old','31 - 35 years old','36 - 40 years old','41 - 50 years old','50+ years or older','#NULL!'))
survey$q2age <- factor(survey$q2age,levels=c("Under 12 years old","12 - 18 years old","18 - 24 years old","25 - 34 years old","35 - 44 years old","45 - 54 years old","55 - 64 years old","65 - 74 years old","75 years or older","#NULL!"))
survey$q5degreefocus <- as.factor(survey$q5degreefocus)
temp_country <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
temp_country$perc <- round((temp_country$respondents/sum(temp_country$respondents))*100,2)
#Visualising,
ggplot(head(temp_country,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?",subtitle="Top 15 Countries")+coord_flip()
View(survey)
sapply(survey,class)
unique(survey$respondentid)
temp_country <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
View(temp_country)
temp_country <- survey %>% filter(countrynumeric2!="") %>% group_by(countrynumeric2) %>% mutate(respondents=count()) %>% arrange(desc(respondents))
temp_country <- survey %>% filter(countrynumeric2!="") %>% group_by(countrynumeric2) %>% mutate(respondents=count(unique(respondentid))) %>% arrange(desc(respondents))
temp_country <- survey %>% filter(countrynumeric2!="") %>% group_by(countrynumeric2) %>% mutate(respondents=length(unique(respondentid))) %>% arrange(desc(respondents))
temp_country <- survey %>% filter(countrynumeric2!="") %>% group_by(countrynumeric2) %>% summarise(respondents=length(unique(respondentid))) %>% arrange(desc(respondents))
View(temp_country)
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!'),.(respondents=.N),by=.(q3gender)][order(-respondents)]
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
ggplot(head(temp),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & countrynumeric2 !="",.(respondents=.N),by=.(countrynumeric2)][order(-respondents)]
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity",aes(fill="pink"))+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
temp <- temp %>% mutate(q5degreefocus=fct_recode(q5degreefocus,"Others"=""))
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the youngest coders completed ?",subtitle="Each grid represents age they have started to code")
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message = FALSE)
library(data.table)
library(tidyverse)
library(gridExtra)
library(janitor)
library(ggthemes)
library(forcats)
library(viridis)
survey=fread('HackerRank-Developer-Survey-2018-Values.csv')
survey <- survey %>% clean_names()
cat("Total Number of respondents:",length(unique(survey$respondentid)))
my_theme <- function(){
theme_bw()+theme(plot.title = element_text(size=16,face='bold',color='maroon'),axis.text.x = element_text(angle=90),legend.position="None",plot.subtitle=element_text(size=10,face="italic",color='black'))
}
survey$countrynumeric2 <- as.factor(survey$countrynumeric2)
survey$q3gender <- as.factor(survey$q3gender)
survey$q1agebegincoding <- factor(survey$q1agebegincoding,levels=c('5 - 10 years old','11 - 15 years old','16 - 20 years old','21 - 25 years old','26 - 30 years old','31 - 35 years old','36 - 40 years old','41 - 50 years old','50+ years or older','#NULL!'))
survey$q2age <- factor(survey$q2age,levels=c("Under 12 years old","12 - 18 years old","18 - 24 years old","25 - 34 years old","35 - 44 years old","45 - 54 years old","55 - 64 years old","65 - 74 years old","75 years or older","#NULL!"))
survey$q5degreefocus <- as.factor(survey$q5degreefocus)
temp_country <- survey %>% filter(countrynumeric2!="") %>% group_by(countrynumeric2) %>% summarise(respondents=length(unique(respondentid))) %>% arrange(desc(respondents))
temp_country <- survey[countrynumeric2!="",.(respondents=length(unique(respondentid))),by=.(countrynumeric2)][order(-respondents)]
temp_country$perc <- round((temp_country$respondents/sum(temp_country$respondents))*100,2)
#Visualising,
ggplot(head(temp_country,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+labs(x="Country",y="No of Respondents",title="Where do the respondents come from?",subtitle="Top 15 Countries")+coord_flip()
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!'),.(respondents=.N),by=.(q3gender)][order(-respondents)]
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
ggplot(head(temp),aes(reorder(q3gender,respondents),respondents,fill=q3gender))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)+labs(x="Gender",y="No of Respondents",title="How do the respondents differ from gender?")
temp_gender <- survey[!q3gender %in% c('Non-Binary','#NULL!') & countrynumeric2 !="",.(respondents=.N),by=.(countrynumeric2,q3gender)][order(-respondents)]
ggplot(temp_gender[temp_gender$countrynumeric2 %in% head(temp_country$countrynumeric2,15),],aes(reorder(countrynumeric2,respondents),respondents,fill=q3gender))+geom_bar(stat="identity",position="dodge")+my_theme()+labs(x="Country",y="No of respondents",title="How is the distribution of gender from countries?",subtitle='Top 15 Countries',fill="Gender")+theme(legend.position="bottom")+coord_flip()
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!',.(respondents=.N),by=.(q2age,q3gender)]
ggplot(temp,aes(q2age,respondents,fill=q3gender))+geom_bar(stat='identity',position="dodge")+my_theme()+theme(legend.position="right")+labs(x="Age",y="Count of respondents",title="Age of the respondents",fill="Gender")+scale_fill_solarized()
temp <- survey[!q3gender %in% c('Non-Binary','#NULL!') & !q2age %in% '#NULL!' & !q1agebegincoding %in% '#NULL!',.(respondents=.N),.(q3gender,q2age,q1agebegincoding)]
ggplot(temp,aes(q1agebegincoding,respondents,fill=q3gender))+geom_bar(stat='identity',position='stack')+my_theme()+facet_wrap(~q2age)+theme(legend.position="right")+labs(x="Coding start age",y="No of respondents",title="When do you begin to code?",subtitle="Each grid represents current age",fill="Gender")
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & countrynumeric2 !="",.(respondents=.N),by=.(countrynumeric2)][order(-respondents)]
temp$perc <- round((temp$respondents/sum(temp$respondents))*100,2)
ggplot(head(temp,15),aes(reorder(countrynumeric2,respondents),respondents,fill=countrynumeric2))+geom_bar(stat="identity",aes(fill="pink"))+my_theme()+labs(x="Country",y="No of respondents",title="Where do the youngest coders come from?",subtitle="Top 15 countries")+geom_text(aes(label=paste(perc,"%")),hjust=0,vjust=0.5)+coord_flip()
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
temp <- temp %>% mutate(q5degreefocus=fct_recode(q5degreefocus,"Others"=""))
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the youngest coders completed ?",subtitle="Each grid represents age they have started to code")
temp <- survey[!q1agebegincoding %in% "#NULL!" & !q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
temp <- temp %>% mutate(q5degreefocus=fct_recode(q5degreefocus,"Others"=""))
ggplot(temp,aes(q5degreefocus,respondents,fill=q5degreefocus))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q1agebegincoding)+labs(x="Degree",y="No of respondents",title="What degree have the coders completed ?",subtitle="Each grid represents age they have started to code")
temp <- melt(survey,id.vars="respondentid",variable.name="Q6_Learn",measure.vars = 12:16)
temp <- temp[value !="",.(respondents=.N),by=.(value)][order(-respondents)]
temp$perc <- round(((temp$respondents)/sum(temp$respondents))*100,2)
ggplot(temp,aes(factor(value,value),respondents,fill=value))+geom_bar(stat="identity")+my_theme()+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)+labs(x="Learning Method",y="No of respondents",title="How did you learn to code?")
temp <- melt(survey,id.vars=c("respondentid","q2age"),variable.name="Q6_Learn",measure.vars = 12:16)
temp <- temp[value !=""& !q2age=="#NULL!",.(respondents=.N),by=.(value,q2age)][order(-respondents)]
temp <- temp %>% group_by(q2age) %>% mutate(perc=round(((respondents)/sum(respondents))*100,2)) %>% arrange(desc(perc))
ggplot(temp,aes(reorder(value,respondents),respondents,fill=q2age))+geom_bar(stat="identity")+my_theme()+facet_wrap(~q2age,scale="free_y")+labs(x="Tool",y="No of respondents",title="How did you learn to code?",subtitle="Each grid represents current age")+scale_fill_manual(values=viridis(9))+geom_text(aes(label=paste(perc,"%")),hjust=0.5,vjust=0)
temp <- survey[q1agebegincoding %in% c("5 - 10 years old","11 - 15 years old") & !q5degreefocus %in% "#NULL!",.(respondents=.N),by=.(q1agebegincoding,q5degreefocus)]
temp <- temp %>% mutate(q5degreefocus=fct_recode(q5degreefocus,"Others"=""))
View(temp)
setwd("~/Downloads/R/Survey Kaggle")
knitr::opts_chunk$set(echo = TRUE,warning = FALSE,message = FALSE)
library(tidyverse)
setwd("~/Downloads/R/Survey Kaggle/kaggle-survey-2017")
setwd("~/Downloads/R/Survey Kaggle")
## Reading the 2018 survey results:
survey <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE)
## Reading the 2018 survey results:
survey <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE)
survey_free <- read.csv("freeFormResponses.csv",header=TRUE,stringsAsFactors = FALSE)
## Reading the 2017 survey results:
setwd("~/Downloads/R/Survey Kaggle/kaggle-survey-2017")
survey_old <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE)
survey_old <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE)
survey_free_old <- read.csv("freeformResponses.csv",header=TRUE,stringsAsFactors = FALSE)
setwd("~/Downloads/R/Survey Kaggle")
## Reading the 2018 survey results:
survey <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE)
setwd("~/Downloads/R/Survey Kaggle/kaggle-survey-2017")
survey_old <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE)
survey_free_old <- read.csv("freeformResponses.csv",header=TRUE,stringsAsFactors = FALSE)
View(survey_old)
## Reading the 2017 survey results:
setwd("~/Downloads/R/Survey Kaggle/kaggle-survey-2017")
survey_old <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE)
survey_free_old <- read.csv("freeformResponses.csv",header=TRUE,stringsAsFactors = FALSE)
setwd("~/Downloads/R/Survey Kaggle")
## Reading the 2018 survey results:
setwd("~/Downloads/R/Survey Kaggle")
survey <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE)
survey_free <- read.csv("freeFormResponses.csv",header=TRUE,stringsAsFactors = FALSE)
View(survey)
View(survey_old)
print("There are",nrow(survey),"respondents compared to 2017 results where there were",nrow(survey_old))
cat("There are",nrow(survey),"respondents compared to 2017 results where there were",nrow(survey_old))
cat("There are",nrow(survey),"respondents compared to **2017** results where there were",nrow(survey_old))
cat("There are",nrow(survey),"respondents compared to 2017 results where there were",nrow(survey_old))
cat("There are",nrow(survey),"respondents compared to 2017 survey where there were",nrow(survey_old))
cat("There are",nrow(survey),"respondents compared to 2017 survey where there were",nrow(survey_old) "which is ",((nrow(survey)-nrow(survey_old))/nrow(survey_old))*100,"% jump")
cat("There are",nrow(survey),"respondents compared to 2017 survey where there were",nrow(survey_old), "which is",((nrow(survey)-nrow(survey_old))/nrow(survey_old))*100,"% jump")
## Reading the 2018 survey results:
setwd("~/Downloads/R/Survey Kaggle")
survey <- read.csv("multipleChoiceResponses.csv",header=TRUE,stringsAsFactors = FALSE,skip=1)
survey_free <- read.csv("freeFormResponses.csv",header=TRUE,stringsAsFactors = FALSE,skip=1)
cat("There are",nrow(survey),"respondents compared to 2017 survey where there were",nrow(survey_old), "which is",((nrow(survey)-nrow(survey_old))/nrow(survey_old))*100,"% jump")
cat("There are",nrow(survey),"respondents compared to 2017 survey where there were",nrow(survey_old), "which is",round(((nrow(survey)-nrow(survey_old))/nrow(survey_old))*100,2),"% jump")
cat("There are",nrow(survey),"respondents compared to 2017 survey where there were",nrow(survey_old), "which is",round(((nrow(survey)-nrow(survey_old))/nrow(survey_old))*100,0),"% jump")
View(survey)
library(janitor)
